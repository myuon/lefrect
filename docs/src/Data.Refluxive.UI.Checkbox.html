<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
  Checkbox component
-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-5"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Refluxive.UI.Checkbox</span><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">(</span><span>
</span><a name="line-7"></a><span>  </span><span class="hs-comment">-- * Model</span><span>
</span><a name="line-8"></a><span>    </span><a href="Data.Refluxive.UI.Checkbox.html#checkState"><span class="hs-identifier hs-var">checkState</span></a><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span>  </span><span class="hs-comment">-- * Event</span><span>
</span><a name="line-11"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Refluxive.UI.Checkbox.html#onChanged"><span class="hs-identifier hs-var">onChanged</span></a><span>
</span><a name="line-12"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">SDL</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">SDL</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">SDL.Vect</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Lens</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.State</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Ix</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">inRange</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><a href="Graphics.UI.Refluxive.html"><span class="hs-identifier">Graphics.UI.Refluxive</span></a><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-cpp">#include &quot;macro.h&quot;
</span><span>
</span><a name="line-23"></a><span class="hs-comment">-- | Checkbox state (checked? or not)</span><span>
</span><a name="line-24"></a><span class="hs-identifier">MAKE_LENS</span><span class="hs-special">(</span><span class="hs-string">&quot;checkbox&quot;</span><span class="hs-special">,</span><a href="Graphics.UI.Refluxive.Component.html#Model"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">,</span><span class="hs-identifier">checkState</span><span class="hs-special">,</span><span class="hs-identifier">_checkState</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-comment">-- | Change event listener for checkbox component</span><span>
</span><a name="line-27"></a><span class="hs-comment">-- | The third argument is a callback, which recieves 'RenderState' and current (after-changed) checkbox state</span><span>
</span><a name="line-28"></a><span class="hs-identifier">onChanged</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.Refluxive.Component.html#Component"><span class="hs-identifier hs-type">Component</span></a><span> </span><a href="Graphics.UI.Refluxive.html#UI"><span class="hs-identifier hs-type">UI</span></a><span> </span><a href="#local-6989586621679214147"><span class="hs-identifier hs-type">tgt</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Graphics.UI.Refluxive.Component.html#ComponentView"><span class="hs-identifier hs-type">ComponentView</span></a><span> </span><span class="hs-string">&quot;checkbox&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.Refluxive.Component.html#ComponentView"><span class="hs-identifier hs-type">ComponentView</span></a><span> </span><a href="#local-6989586621679214147"><span class="hs-identifier hs-type">tgt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.Refluxive.Graphical.html#RenderState"><span class="hs-identifier hs-type">RenderState</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">StateT</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.Refluxive.Component.html#Model"><span class="hs-identifier hs-type">Model</span></a><span> </span><a href="#local-6989586621679214147"><span class="hs-identifier hs-type">tgt</span></a><span class="hs-special">)</span><span> </span><a href="Graphics.UI.Refluxive.html#UI"><span class="hs-identifier hs-type">UI</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.Refluxive.html#UI"><span class="hs-identifier hs-type">UI</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><a name="onChanged"><a href="Data.Refluxive.UI.Checkbox.html#onChanged"><span class="hs-identifier">onChanged</span></a></a><span> </span><a name="local-6989586621679214150"><a href="#local-6989586621679214150"><span class="hs-identifier">btn</span></a></a><span> </span><a name="local-6989586621679214151"><a href="#local-6989586621679214151"><span class="hs-identifier">tgt</span></a></a><span> </span><a name="local-6989586621679214152"><a href="#local-6989586621679214152"><span class="hs-identifier">callback</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.Refluxive.html#addWatchSignal"><span class="hs-identifier hs-var">addWatchSignal</span></a><span> </span><a href="#local-6989586621679214151"><span class="hs-identifier hs-var">tgt</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Graphics.UI.Refluxive.html#watch"><span class="hs-identifier hs-var">watch</span></a><span> </span><a href="#local-6989586621679214150"><span class="hs-identifier hs-var">btn</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679214153"><a href="#local-6989586621679214153"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-30"></a><span>  </span><a href="Data.Refluxive.UI.Checkbox.html#Changed"><span class="hs-identifier hs-var">Changed</span></a><span> </span><a name="local-6989586621679214154"><a href="#local-6989586621679214154"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679214152"><span class="hs-identifier hs-var">callback</span></a><span> </span><a href="#local-6989586621679214153"><span class="hs-identifier hs-var">rs</span></a><span> </span><a href="#local-6989586621679214154"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-keyword">instance</span><span> </span><a href="Graphics.UI.Refluxive.Component.html#Component"><span class="hs-identifier hs-type">Component</span></a><span> </span><a href="Graphics.UI.Refluxive.html#UI"><span class="hs-identifier hs-type">UI</span></a><span> </span><span class="hs-string">&quot;checkbox&quot;</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-33"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">ModelParam</span><span> </span><span class="hs-string">&quot;checkbox&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>  </span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Model</span><span> </span><span class="hs-string">&quot;checkbox&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="CheckBoxModel"><a href="Data.Refluxive.UI.Checkbox.html#CheckBoxModel"><span class="hs-identifier">CheckBoxModel</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="_checkState"><a href="Data.Refluxive.UI.Checkbox.html#_checkState"><span class="hs-identifier">_checkState</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-35"></a><span>  </span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Signal</span><span> </span><span class="hs-string">&quot;checkbox&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="Changed"><a href="Data.Refluxive.UI.Checkbox.html#Changed"><span class="hs-identifier">Changed</span></a></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span>  </span><a name="local-8214565720323948472"><a href="Graphics.UI.Refluxive.Component.html#newModel"><span class="hs-identifier">newModel</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Refluxive.UI.Checkbox.html#CheckBoxModel"><span class="hs-identifier hs-var">CheckBoxModel</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span>  </span><a name="local-8214565720323948473"><a href="Graphics.UI.Refluxive.Component.html#initComponent"><span class="hs-identifier">initComponent</span></a></a><span> </span><a name="local-6989586621679214119"><a href="#local-6989586621679214119"><span class="hs-identifier">self</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-40"></a><span>    </span><a name="local-6989586621679214120"><a href="#local-6989586621679214120"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">use</span><span> </span><a href="Graphics.UI.Refluxive.html#_builtIn"><span class="hs-identifier hs-var">_builtIn</span></a><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span>    </span><a href="Graphics.UI.Refluxive.html#addWatchSignal"><span class="hs-identifier hs-var">addWatchSignal</span></a><span> </span><a href="#local-6989586621679214119"><span class="hs-identifier hs-var">self</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Graphics.UI.Refluxive.html#watch"><span class="hs-identifier hs-var">watch</span></a><span> </span><a href="#local-6989586621679214120"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679214121"><a href="#local-6989586621679214121"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-43"></a><span>      </span><a href="Graphics.UI.Refluxive.html#BuiltInSignal"><span class="hs-identifier hs-var">BuiltInSignal</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SDL.Event</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SDL.MouseButtonEvent</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SDL.MouseButtonEventData</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">SDL.Pressed</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">SDL.ButtonLeft</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SDL.P</span><span> </span><a name="local-6989586621679214122"><a href="#local-6989586621679214122"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-44"></a><span>        </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">inRange</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">coordinate</span><span> </span><a href="#local-6989586621679214121"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">coordinate</span><span> </span><a href="#local-6989586621679214121"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-number">30</span><span> </span><span class="hs-number">30</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679214122"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-45"></a><span>          </span><span class="hs-identifier hs-var">modify</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Data.Refluxive.UI.Checkbox.html#CheckBoxModel"><span class="hs-identifier hs-var">CheckBoxModel</span></a><span> </span><a name="local-6989586621679214123"><a href="#local-6989586621679214123"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Refluxive.UI.Checkbox.html#CheckBoxModel"><span class="hs-identifier hs-var">CheckBoxModel</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621679214123"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span>          </span><a href="Data.Refluxive.UI.Checkbox.html#CheckBoxModel"><span class="hs-identifier hs-var">CheckBoxModel</span></a><span> </span><a name="local-6989586621679214124"><a href="#local-6989586621679214124"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">get</span><span>
</span><a name="line-48"></a><span>          </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Graphics.UI.Refluxive.html#emit"><span class="hs-identifier hs-var">emit</span></a><span> </span><a href="#local-6989586621679214119"><span class="hs-identifier hs-var">self</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Refluxive.UI.Checkbox.html#Changed"><span class="hs-identifier hs-var">Changed</span></a><span> </span><a href="#local-6989586621679214124"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-49"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span>  </span><a name="local-8214565720323948474"><a href="Graphics.UI.Refluxive.Component.html#getGraphical"><span class="hs-identifier">getGraphical</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Refluxive.UI.Checkbox.html#CheckBoxModel"><span class="hs-identifier hs-var">CheckBoxModel</span></a><span> </span><a name="local-6989586621679214146"><a href="#local-6989586621679214146"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-52"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Graphics.UI.Refluxive.Graphical.html#graphics"><span class="hs-identifier hs-var">graphics</span></a><span>
</span><a name="line-53"></a><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679214146"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-54"></a><span>        </span><span class="hs-keyword">then</span><span> </span><a href="Graphics.UI.Refluxive.Graphical.html#colored"><span class="hs-identifier hs-var">colored</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V4</span><span> </span><span class="hs-number">50</span><span> </span><span class="hs-number">150</span><span> </span><span class="hs-number">50</span><span> </span><span class="hs-number">255</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Graphics.UI.Refluxive.Graphical.html#textDef"><span class="hs-identifier hs-var">textDef</span></a><span> </span><span class="hs-string">&quot;&#10003;&quot;</span><span>
</span><a name="line-55"></a><span>        </span><span class="hs-keyword">else</span><span> </span><a href="Graphics.UI.Refluxive.Graphical.html#colored"><span class="hs-identifier hs-var">colored</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V4</span><span> </span><span class="hs-number">200</span><span> </span><span class="hs-number">200</span><span> </span><span class="hs-number">200</span><span> </span><span class="hs-number">255</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Graphics.UI.Refluxive.Graphical.html#textDef"><span class="hs-identifier hs-var">textDef</span></a><span> </span><span class="hs-string">&quot;&#9633;&quot;</span><span>
</span><a name="line-56"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-57"></a></pre></body></html>